package com.example.vulnerabilitysdksystem.vulnerabilities.network;


import com.example.vulnerabilitysdksystem.vulnerabilities.model.AuthResponse;
import com.example.vulnerabilitysdksystem.vulnerabilities.model.ScanResponse;
import com.example.vulnerabilitysdksystem.vulnerabilities.model.ScanHistoryResponse;
import com.example.vulnerabilitysdksystem.vulnerabilities.model.DeleteResponse;

import retrofit2.Call;
import retrofit2.http.*;
import java.util.Map;

public interface VulnerabilityService {
    // Authentication endpoint
    @POST("auth/register")
    Call<AuthResponse> register(@Body Map<String, String> credentials);

    // Core vulnerability endpoints
    @POST("scan")
    Call<ScanResponse> scanCode(@Header("Authorization") String token, @Body Map<String, String> scanRequest, @Query("include_code") boolean includeCode);

    @GET("scans")
    Call<ScanHistoryResponse> getScanHistory(@Header("Authorization") String token, @Query("include_code") boolean includeCode);

    @GET("scans/{scanId}")
    Call<ScanResponse> getScanDetails(@Header("Authorization") String token, @Path("scanId") String scanId, @Query("include_code") boolean includeCode);

    @DELETE("scans/{scanId}")
    Call<DeleteResponse> deleteScan(@Header("Authorization") String token, @Path("scanId") String scanId);
}